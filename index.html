<html>
<head>
  <script src="main.js"></script>
  <script src="graph.js"></script>
  <script>
  </script>
  <script type="text/javascript" src="ejs.js"></script>
  <link rel="stylesheet" href="styles/styles.css">
  <script>

  </script>
</head>
<body>
  <canvas id="expGraph"></canvas>
  <div id="detailsPanel">
    View detailed spending for -
  </div>
  <a href="/add.html" id="add">Add New Expense</a>
  <script>

  loadPartial("/category_links.ejs", "/categories.json", document.getElementById("detailsPanel"), function(jsonresponse)
   {
     //This needs to be inside since I am calling assignColors too -- which relies on the existence of certain elements which are generated by loadPartial.
     //I need to have assignColors with the rest of the code because the colors won't be common otherwise.(keys is not in any particular order...)
    loadFile("/load?filter=CategoryValue", "application/json", function(d) {
      d = JSON.parse(d);
      var keys = Object.keys(d); //Also, these are the categories
      var values = [];
      for(var i=0; i!=keys.length; i++) {
        values.push(d[keys[i]]);
      }
      //alert(keys);
      var g = new Graph(values, keys);
      alert(values);
      alert(keys);
      g.plotGraph(document.getElementById("expGraph"), window.innerWidth/1.01, window.innerHeight/1.4)
      assignColors(keys);

    });

  }
);




  </script>
</body>
</html>
